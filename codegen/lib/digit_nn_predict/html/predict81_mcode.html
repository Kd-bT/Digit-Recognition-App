<pre class="code">
<span class="srcline"><span class="lineno"><a href="35,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T5U3">p</span> = predict(<span class="var type1" id="S3T2U6">Theta1</span>, <span class="var type1" id="S4T3U7">Theta2</span>, <span class="var type1" id="S5T4U8">X</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="35,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%PREDICT Predict the label of an input given a trained neural network</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   p = PREDICT(Theta1, Theta2, X) outputs the predicted label of X given the</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%   trained weights of a neural network (Theta1, Theta2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% Useful values</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T5:U5"><span class="var type1" id="S6T5U11">m</span> = <span class="mxinfo " id="T5:U7">size(<span class="var type1" id="S5T4U14">X</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%num_labels = size(Theta2, 1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,10" id="srcline10">10</a></span><span class="line"><span class="comment">% You need to return the following variables correctly </span></span></span>
<span class="srcline"><span class="lineno"><a href="35,11" id="srcline11">11</a></span><span class="line"><span class="comment">%p = zeros(size(X, 1), 1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,12" id="srcline12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T13:U9"><span class="var type1" id="S8T13U18">h1</span> = <span class="mxinfo " id="T13:U11"><span class="fcn" id="F33N4:B20">sigmoid</span>(<span class="mxinfo " id="T13:U12"><span class="mxinfo " id="T6:U13">[<span class="mxinfo " id="T5:U14">ones(<span class="var type1" id="S6T5U26">m</span>, 1)</span> <span class="var type1" id="S5T4U28">X</span>]</span> * <span class="mxinfo " id="T7:U17"><span class="var type1" id="S3T2U30">Theta1</span>'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T18:U19"><span class="var type1" id="S11T18U33">h2</span> = <span class="mxinfo " id="T18:U21"><span class="fcn" id="F60N4:B35">sigmoid</span>(<span class="mxinfo " id="T18:U22"><span class="mxinfo " id="T16:U23">[<span class="mxinfo " id="T5:U24">ones(<span class="var type1" id="S6T5U41">m</span>, 1)</span> <span class="var type1" id="S8T13U43">h1</span>]</span> * <span class="mxinfo " id="T17:U27"><span class="var type1" id="S4T3U45">Theta2</span>'</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="35,15" id="srcline15">15</a></span><span class="line"><span class="comment">%[dummy, p] = max(h2, [], 2);</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,16" id="srcline16">16</a></span><span class="line">[<span class="mxinfo " id="T5:U29"><span class="mxinfo " id="T5:U30">~</span></span>, <span class="mxinfo " id="T5:U31"><span class="var type1" id="S2T5U50">p</span></span>] = max(<span class="var type1" id="S11T18U53">h2</span>, [], 2);</span></span>
<span class="srcline"><span class="lineno"><a href="35,17" id="srcline17">17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,18" id="srcline18">18</a></span><span class="line"><span class="comment">% =========================================================================</span></span></span>
<span class="srcline"><span class="lineno"><a href="35,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,20" id="srcline20">20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="35,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
